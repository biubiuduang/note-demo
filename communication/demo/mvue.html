<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>手写vue</title>
</head>
<body>
<div id="app">
  <!-- demo1 -->
  <p>{{count}}</p>
</div>

<!-- demo1 -->
<!--<script src="../node_modules/vue/dist/vue.js"></script>-->
<!--<script>-->
<!--  new Vue({-->
<!--    el: "#app",-->
<!--    data() {-->
<!--      return {-->
<!--        count: 2-->
<!--      };-->
<!--    },-->
<!--  })-->
<!--</script>-->

<!-- demo2 -->
<script>
  function defineReactive(obj,key,val){
    //解决obj嵌套问题
    observe(val);
    Object.defineProperty(obj,key,{
      get() {
        console.log(`get ${key}:${val}`);
        return val
      },
      set(newVal){
        console.log(`set ${key} : ${newVal}`);
        if(newVal !== val){
          observe(newVal)
          val = newVal;
          undate();
        }
      }
    })
  }
  function undate(){
    app.innerText = obj.foo
  }
  function observe(obj){
    if(typeof obj !== "object" || obj == null){
      return
    }
    Object.keys(obj).forEach(key=>{
      defineReactive(obj,key,obj[key])
    })
  }
  function set(obj,key,val){
    defineReactive(obj,key,val)
  }
  const obj = {foo: 'foo',bar : 'bar',a : {b: 1} };
  observe(obj);
  
  set(obj,'duang','duang');
  obj.duang;

  // setInterval(()=>{
  //   obj.foo = new Date().toLocaleString();
  // },1000)
</script>
</body>
</html>
